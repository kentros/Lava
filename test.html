<!DOCTYPE html> 
<html> 
  <head> 
    <meta charset='utf-8' /> 
    <title>LavaFlow Test</title>

		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.3/jquery.min.js" type="text/javascript"></script>
		<script type="text/javascript">
			var $j = jQuery.noConflict();
		</script>
		
		<style type="text/css">
			body{ 
				margin: 5em;
				background: black;
			}
			#stage {
				position: absolute;
				top: 300px;
				left: 400px;
				background: black;
				-webkit-transform-style: preserve-3d;
				-webkit-perspective: 700px;
			}
			
			#stage div { 
				position: absolute;
				left: 0px;
				top: -125px; /* should be ~ half its height */
				width: 250px; 
				border: 1px solid black; 
				-webkit-border-radius: 10px; 
				-webkit-box-reflect:below 1px -webkit-gradient(linear, left top, left bottom, from(transparent), color-stop(0.25, transparent), to(rgba(0,0,0,0.5)));
				-webkit-background-clip: padding-box;
			}
			#stage > :nth-child(odd) { background: red; }
			#stage > :nth-child(even) { background: blue; }
			
			#stage div .mask {
				position: absolute;
				left: 0;
				top: 0;
				width: 100%; height: 100%;
			}
			
			
			#l3 { -webkit-transform: translateZ(-250px) translateX(-335px) rotateY(55deg) translateZ(3px); }
				#l3 .mask { background: rgba(0,0,0,0.8); }
			#l2 { -webkit-transform: translateZ(-225px) translateX(-260px) rotateY(55deg) translateZ(2px); }
				#l2 .mask { background: rgba(0,0,0,0.2); }
			#l1 { -webkit-transform: translateZ(-200px) translateX(-185px) rotateY(55deg) translateZ(1px); }
				#l1 .mask { background: rgba(0,0,0,0.05); }
			#c { background-color: green; }
				#c .mask { display: none; }
			#r1 { -webkit-transform: translateZ(-200px) translateX(215px) rotateY(-55deg) translateZ(-1px); }
				#r1 .mask { background: rgba(0,0,0,0.05); }
			#r2 { -webkit-transform: translateZ(-225px) translateX(290px) rotateY(-55deg) translateZ(-2px); }
				#r2 .mask { background: rgba(0,0,0,0.2); }
			#r3 { -webkit-transform: translateZ(-250px) translateX(365px) rotateY(-55deg) translateZ(-3px); }
				#r3 .mask { background: rgba(0,0,0,0.8); }
			
			
			
				/* Animations... */
				#stage div { 
					/* cubic-bezier(x1, y1, x2, y2) where P0 and P1 are (0,0) and (1,1) repectively */
					-webkit-transition: -webkit-transform 1s cubic-bezier(0, 0.7, 0.58, 1.0);
				}
				#stage div:hover { 
					-webkit-transform: translateZ(-250px) translateX(-335px) rotateY(55deg) translateZ(3px);
				}
			
			
			/*
			
			TODO:
				1) Design jquery plugin algo for core flow animation
				2) Build jquery plugin (very basic)
				3) Add functionality to jquery plugin
			
			Algorithm for above:
			
			Let n = object location along x-axis (moving left is negative) where n=0 is center object.
			Let maxN = maximum number of objects shown to left or right of center object
			
			#stage { /* div holding all elements in LavaFlow
				-webkit-transform-style: preserve-3d;
				-webkit-perspective: 2.8*width;	
			}
			
			.all-objects {
				position: absolute;
				top: -(width/2) px
			}
				
			#center-object { }
			
			nth OBJECT {
				translateZ( -((width * .8) + |(n-1)|*25) px)
				translateX( (width * .56) + n*75 px)
				rotateY( -(sign of n)*55 deg)
				translateX( -(n) px)
			}
			
			.mask {
				position: absolute;
				left: 0; top: 0;
				width: 100%; height: 100%;
			}
				
			nth OBJECT .mask {
				if(n == 0){ display: none }
				
				ALPHA = [(1+(n/maxN)^2) / 2]^2
				background: rgba(0,0,0, min(ALPHA - .2, 0.5) )
			}
			 
			*/
			
		</style>
		
	</head>
	
	<body>
		<div id="stage">
			
			<div id="l1">
				<div class="mask"></div>
				<h1>L1</h1>
				<p>The quick brown fox jumped over the lazy dog</p>
				<ol>
					<li>DAN</li>
					<li>john</li>
					<li>Peter</li>
					<li>$pinosa</li>
				</ol>
			</div>
			
			<div id="l2">
				<div class="mask"></div>
				<h1>L2</h1>
				<p>The quick brown fox jumped over the lazy dog</p>
				<ol>
					<li>Daniel</li>
					<li>john</li>
					<li>Peter</li>
					<li>$pinosa</li>
				</ol>
			</div>
			
			<div id="l3">
				<div class="mask"></div>
				<h1>L3</h1>
				<p>The quick brown fox jumped over the lazy dog</p>
				<ol>
					<li>Daniel</li>
					<li>john</li>
					<li>Peter</li>
					<li>$pinosa</li>
				</ol>
			</div>
			
			<div id="c">
				<div class="mask"></div>
				<h1>Hey baby</h1>
				<p>The quick brown fox jumped over the lazy dog</p>
				<ol>
					<li>Daniel</li>
					<li>john</li>
					<li>Peter</li>
					<li>$pinosa</li>
				</ol>
			</div>
			
			<div id="r1">
				<div class="mask"></div>
				<h1>R1</h1>
				<p>The quick brown fox jumped over the lazy dog</p>
				<ol>
					<li>Daniel</li>
					<li>john</li>
					<li>Peter</li>
					<li>$pinosa</li>
				</ol>
			</div>
			
			<div id="r2">
				<div class="mask"></div>
				<h1>R2</h1>
				<p>The quick brown fox jumped over the lazy dog</p>
				<ol>
					<li>Daniel</li>
					<li>john</li>
					<li>Peter</li>
					<li>$pinosa</li>
				</ol>
			</div>
			
			<div id="r3">
				<div class="mask"></div>
				<h1>R3</h1>
				<p>The quick brown fox jumped over the lazy dog</p>
				<ol>
					<li>Daniel</li>
					<li>john</li>
					<li>Peter</li>
					<li>$pinosa</li>
				</ol>
			</div>
			
		</div>
	</body>

</html>